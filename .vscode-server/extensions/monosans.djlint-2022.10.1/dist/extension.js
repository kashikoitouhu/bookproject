(()=>{"use strict";var e={569:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCommonArgs=void 0,t.getCommonArgs=function(e,t){const n=function(e,t){if(!t.get("guessProfile"))return[];switch(e.languageId){case"django-html":return["--profile","django"];case"handlebars":case"hbs":case"mustache":return["--profile","handlebars"];case"jinja":case"jinja-html":return["--profile","jinja"];case"nj":case"njk":case"nunjucks":case"twig":return["--profile","nunjucks"];default:return[]}}(e,t),r=t.get("configuration");return r&&n.push("--configuration",r),n}},601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.supportedLanguages=void 0,t.supportedLanguages=["html","django-html","handlebars","hbs","mustache","jinja-html","jinja","nj","njk","nunjucks","twig"]},877:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMsg=void 0;const n=[["configuration","configuration","1.13.0"],["format-css","formatCss","1.9.0"],["format-js","formatJs","1.9.0"],["preserve-blank-lines","preserveBlankLines","1.3.0"],["preserve-leading-space","preserveLeadingSpace","1.2.0"]],r=/Linting\s\d+\/\d+\sfiles/;t.getErrorMsg=function(e){if(e.endsWith("No module named djlint"))return"djLint is not installed for the current active Python interpreter.";for(const[t,r,o]of n)if(e.includes(`Error: No such option: --${t}`))return`Your version of djLint does not support the ${r} option. Disable it in the settings or install djLint>=${o}.`;return r.test(e)?null:e}},654:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Formatter=void 0;const r=n(496),o=n(569),s=n(949),i=n(585),a=n(593),c=[["requirePragma","--require-pragma"],["preserveLeadingSpace","--preserve-leading-space"],["preserveBlankLines","--preserve-blank-lines"],["formatCss","--format-css"],["formatJs","--format-js"]];t.Formatter=class{async provideDocumentFormattingEdits(e,t){const n=(0,a.getConfig)();let u;try{u=await(0,s.getPythonExec)(e,n)}catch(e){return[]}const d=function(e,t,n){const r=["--reformat"].concat((0,o.getCommonArgs)(e,t));t.get("useEditorIndentation")&&r.push("--indent",n.tabSize.toString());for(const[e,n]of c)t.get(e)&&r.push(n);return r}(e,n,t);let g;try{g=await(0,i.runDjlint)(e,u,d)}catch(e){return[]}if(!g||0===g.trim().length)return[];const l=e.lineCount-1,f=e.lineAt(l).text.length,p=new r.Range(0,0,l,f);return[r.TextEdit.replace(p,g)]}}},379:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshDiagnostics=void 0;const r=n(496),o=n(569),s=n(601),i=n(949),a=n(585),c=n(593),u=/^([A-Z]+\d+)\s+(\d+):(\d+)\s+(.+)$/gm;t.refreshDiagnostics=async function(e,t){if(!s.supportedLanguages.includes(e.languageId))return;const n=(0,c.getConfig)();if(!n.get("enableLinting"))return;let d;try{d=await(0,i.getPythonExec)(e,n)}catch(e){return}const g=function(e,t){const n=["--lint"].concat((0,o.getCommonArgs)(e,t)),r=t.get("ignore");return void 0!==r&&0!==r.length&&n.push("--ignore",r.join(",")),n}(e,n);let l;try{l=await(0,a.runDjlint)(e,d,g)}catch(e){return}const f=[],p=l.matchAll(u);for(const e of p){const t=parseInt(e[2])-1,n=parseInt(e[3]),o=new r.Range(t,n,t,n),s=`${e[4]} (${e[1]})`,i=new r.Diagnostic(o,s);f.push(i)}t.set(e.uri,f)}},949:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPythonExec=void 0;const r=n(496);t.getPythonExec=async function(e,t){if(t.get("useVenv")){const t=r.extensions.getExtension("ms-python.python");if(t){const n=(t.isActive?t.exports:await t.activate()).settings.getExecutionDetails(e.uri).execCommand;if(n){const e=n.shift();if(e)return[e,n]}const o="Failed to get Python interpreter from Python extension.";throw r.window.showErrorMessage(o),new Error(o)}}const n=t.get("pythonPath");if(n)return[n,[]];const o="Invalid djlint.pythonPath setting.";throw r.window.showErrorMessage(o),new Error(o)}},585:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runDjlint=void 0;const r=n(81),o=n(496),s=n(877);t.runDjlint=function(e,t,n){return new Promise(((i,a)=>{let c="",u="";const d=t[1].concat(["-m","djlint","-"]).concat(n),g={cwd:o.Uri.joinPath(e.uri,"..").fsPath},l=(0,r.spawn)(t[0],d,g);l.stdin.write(e.getText()),l.stdin.end(),l.stdout.on("data",(e=>{c+=e})),l.stderr.on("data",(e=>{u+=e})),l.on("close",(()=>{u=u.trim();const e=(0,s.getErrorMsg)(u);e?(o.window.showErrorMessage(e),a(new Error(u))):i(c)}))}))}},593:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getConfig=void 0;const r=n(496);t.getConfig=function(){return r.workspace.getConfiguration("djlint")}},496:e=>{e.exports=require("vscode")},81:e=>{e.exports=require("child_process")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.activate=void 0;const t=n(496),o=n(601),s=n(654),i=n(379);e.activate=function(e){const n=t.languages.createDiagnosticCollection("djLint");t.window.activeTextEditor&&(0,i.refreshDiagnostics)(t.window.activeTextEditor.document,n);const r=e=>{(0,i.refreshDiagnostics)(e,n)};e.subscriptions.push(t.workspace.onDidOpenTextDocument(r),t.workspace.onDidSaveTextDocument(r),t.workspace.onDidCloseTextDocument((e=>n.delete(e.uri)))),t.languages.registerDocumentFormattingEditProvider(o.supportedLanguages,new s.Formatter)}})(),module.exports=r})();